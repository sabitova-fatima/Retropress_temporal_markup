#include <R.h>
#include <Rinternals.h>

int		l_b(char const *str, int c)
{
  int	i;
  int	n;
  
  i = 0;
  n = 0;
  while (str[i])
  {
    if (str[i] == c && str[i + 1] != c)
      n++;
    i++;
  }
  return (n);
}

int		l_s(char const *str, int c, int i)
{
  int	n;
  
  n = 0;
  while (str[i] != c && str[i] != '\0')
  {
    i++;
    n++;
  }
  return (n);
}

char	**ft_split(char const *str, int c)
{
  int		i;
  int		j;
  int		k;
  char	**res;
  
  i = 0;
  k = 0;
  if (!str || !(res = (char **)malloc(sizeof(char *) * (l_b(str, c) + 2))))
    return (NULL);
  while (str[i] == c && str[i] != '\0')
    i++;
  while (str[i])
  {
    j = 0;
    if (!(res[k] = (char *)malloc(sizeof(char **) * (l_s(str, c, i) + 2))))
      return (NULL);
    while (str[i] != c && str[i] != '\0')
      res[k][j++] = str[i++];
    while (str[i] == c && str[i] != '\0')
      i++;
    res[k][j] = '\0';
    k++;
  }
  res[k] = NULL;
  return (res);
}
